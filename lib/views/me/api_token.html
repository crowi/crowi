{% extends '../layout/single.html' %}


{% block html_title %}{{ t('API Settings') }} Â· {{ path }}{% endblock %}

{% block content_head %}
<div class="header-wrap">
  <header id="page-header">
  <h1 class="title" id="">{{ t('User Settings') }}</h1>
  </header>
</div>
{% endblock %}

{% block content_main %}
<div class="content-main content-form">

  <ul class="nav nav-tabs">
    <li class="nav-item"><a class="nav-link" href="/me"><i class="mdi mdi-cogs"></i> {{ t('User Information') }}</a></li>
    {% if not config.crowi['auth:disablePasswordAuth'] %}
    <li class="nav-item"><a class="nav-link" href="/me/password"><i class="mdi mdi-key"></i> {{ t('Password Settings') }}</a></li>
    {% endif %}
    <li class="nav-item"><a class="nav-link" href="/me/notifications"><i class="mdi mdi-bell"></i> Notifications</a></li>
    <li class="nav-item"><a class="nav-link active" href="/me/apiToken"><i class="mdi mdi-rocket"></i> {{ t('API Settings') }}</a></li>
  </ul>

  <div class="tab-content">

  {% set message = req.flash('successMessage') %}
  {% if message.length %}
  <div class="alert alert-success">
    {{ message }}
  </div>
  {% endif %}

  {% if req.form.errors.length > 0 %}
  <div class="alert alert-danger">
    <ul>
    {% for error in req.form.errors %}
      <li>{{ error }}</li>
    {% endfor %}
    </ul>
  </div>
  {% endif %}

  <div id="form-box">

    <form action="/me/apiToken" method="post" class="form-horizontal" role="form">
    <fieldset>
      <legend>{{ t('API Token Settings') }}</legend>
      <div class="form-group row {% if not user.password %}has-error{% endif %}">
        <label for="" class="col-3 control-label">{{ t('Current API Token') }}</label>
        <div class="col-6">
          {% if user.apiToken %}
            <input class="form-control" type="text" value="{{ user.apiToken }}" readonly>
          {% else %}
          <p class="form-control-static">
            {{ t('page_me_apitoken.notice.apitoken_issued') }}
          </p>
          {% endif %}
        </div>
      </div>

      <div class="form-group">
        <div class="offset-3 col-8">

          <p class="alert alert-warning">
            {{ t('page_me_apitoken.notice.update_token1') }}<br>
            {{ t('page_me_apitoken.notice.update_token2') }}
          </p>

          <button type="submit" value="1" name="apiTokenForm[confirm]" class="btn btn-primary">{{ t('Update API Token') }}</button>
        </div>
      </div>

    </fieldset>
    </form>
  </div>


  </div>
</div>
{% endblock content_main %}

{% block content_footer %}
{% endblock %}

{% block footer %}
{% endblock %}
